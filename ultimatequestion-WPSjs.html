<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd"
     xml:lang="en" >
    <head>
        <title>PyWPS: Ultimate Question Process</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <script type="text/javascript" src="http://openlayers.org/api/OpenLayers.js"></script>
        <script type="text/javascript" src="WPS.js"></script>

        <script type="text/javascript">

            /**
             * This is example, how co create custom JavaScript Client,
             * based on WPS.js file (which contains OpenLayers.WPS class).
             * The example works for "Ultimate Question Process". The
             * process has no input and one output. It is worth, to run the
             * process in assynchronous mode
             * /

            /**
             * Called, when button is clicked
             */
            var calculate =function() {

                // set the proxy host for ajax communication
                OpenLayers.ProxyHost = "/cgi-bin/olproxy.cgi?url=";
                
                // create the wps object
                // one mandatory parameter: url
                // optional parameters: functions, which will be called on
                // status chage
                var wps = new OpenLayers.WPS("http://localhost/cgi-bin/wps-trunk",
                                    {
                                        onSucceeded : onSucceeded,
                                        onStatusChanged : onStatusChanged
                                    });

                // define the LiteralOutput for this process
                var answer = new OpenLayers.WPS.LiteralPut({
                        identifier: "answer",
                        title: "Answer",
                        });

                // define the process, with one output
                var uqp = new OpenLayers.WPS.Process({
                        identifier: "ultimatequestionprocess",
                        assync: true,
                        outputs : [answer]
                        });

                // add the process to wps
                wps.addProcess(uqp);

                // execute the process
                wps.execute(uqp.identifier);
            };

            /**
             * This function is called, when process is successfully
             * calculated
             */
            var onSucceeded = function(process) {
                document.getElementById("resultmsg").innerHTML = process.outputs.title+": "+ process.outputs[0].getValue();
            };

            /**
             * This function is called, when status has chagned
             */
            var onStatusChanged = function(status,process) {
                document.getElementById("statusmsg").innerHTML = status+" "+process.wps.percentCompleted+"%: "+process.wps.statusMessage;
            };

        </script>
        <style>
        </style>
    </head>
    <body onload="">
        <h1>Ultimate Question Process</h1>
        <input type="button" value="Calculate" onclick="calculate();"></input>

        <div id="statusmsg">&nbsp;
        </div>
        <div id="resultmsg">&nbsp;
        </div>
        Powered by: <a href="http://pywps.wald.intevation.org">PyWPS</a> (server), <a href="http://openlayers.org">OpenLayers</a> (web client)
    </body>
</html>

